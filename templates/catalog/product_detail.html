{% extends 'base.html' %}

{% block title %}{{ product.name }} - Samar Craft Services{% endblock %}

{% block meta_description %}{{ product.short_description|default:product.description|striptags|truncatewords:25 }}{%
endblock %}
{% block meta_keywords %}stone services, {{ product.category.name|lower }}, {{ product.name|lower }}{% endblock %}

{% block og_title %}{{ product.name }} - Samar Craft Services{% endblock %}
{% block og_description %}{{ product.short_description|default:product.description|striptags|truncatewords:25 }}{%
endblock %}
{% block og_image %}{% if product.get_primary_image %}{{ product.get_primary_image.image.url }}{% else %}{{ block.super
}}{% endif %}{% endblock %}

{% block content %}
<section style="padding: 2rem 0;">
    <div style="max-width: 1000px; margin: 0 auto;">
        <!-- Breadcrumb -->
        <div style="margin-bottom: 1rem;">
            <a href="{% url 'core:home' %}" style="color: var(--primary-color); text-decoration: none;">Home</a>
            <span style="margin: 0 0.5rem;">/</span>
            <a href="{% url 'catalog:product_list' %}"
                style="color: var(--primary-color); text-decoration: none;">Services</a>
            <span style="margin: 0 0.5rem;">/</span>
            <span>{{ product.name }}</span>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 2rem;">
            <!-- Image Gallery -->
            <div>
                {% if product.images.all %}
                <div id="main-image" style="margin-bottom: 1rem;">
                    <img src="{{ product.get_primary_image.image.url }}" alt="{{ product.name }}"
                        style="width: 100%; height: 400px; object-fit: cover; border-radius: 8px;">
                </div>

                {% if product.images.count > 1 %}
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 0.5rem;">
                    {% for image in product.images.all %}
                    <img src="{{ image.image.url }}" alt="{{ product.name }}"
                        onclick="document.getElementById('main-image').innerHTML='<img src=\'{{ image.image.url }}\' alt=\'{{ product.name }}\' style=\'width: 100%; height: 400px; object-fit: cover; border-radius: 8px;\'>'"
                        style="width: 100%; height: 100px; object-fit: cover; border-radius: 4px; cursor: pointer; border: 2px solid {% if image.is_primary %}var(--primary-color){% else %}transparent{% endif %};">
                    {% endfor %}
                </div>
                {% endif %}
                {% else %}
                <div
                    style="width: 100%; height: 400px; background: #eee; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
                    <p style="color: #999;">No images available</p>
                </div>
                {% endif %}
            </div>

            <!-- Product Details -->
            <div>
                <h1 style="margin-bottom: 0.5rem;">{{ product.name }}</h1>
                {% if product.category %}
                <p style="color: var(--primary-color); font-size: 1.1rem; margin-bottom: 1rem;">
                    {{ product.category.name }}
                </p>
                {% endif %}

                <p style="font-size: 1.1rem; color: #666; margin-bottom: 1.5rem;">{{ product.short_description }}</p>

                {% if product.price_note %}
                <div style="background: #f5f5f5; padding: 1rem; border-radius: 4px; margin-bottom: 1.5rem;">
                    <p style="font-weight: bold; font-size: 1.2rem; margin: 0;">{{ product.price_note }}</p>
                </div>
                {% endif %}

                <div style="margin-bottom: 2rem;">
                    <h3 style="margin-bottom: 1rem;">Description</h3>
                    <div style="line-height: 1.6;">{{ product.description|linebreaks }}</div>
                </div>

                <!-- WhatsApp CTA -->
                <a href="https://wa.me/{{ whatsapp_number }}?text=Hi, I'm interested in {{ product.name }}"
                    target="_blank"
                    style="display: inline-block; padding: 1rem 2rem; background: #25D366; color: white; text-decoration: none; border-radius: 4px; font-size: 1.1rem; font-weight: bold;">
                    <span style="margin-right: 0.5rem;">üí¨</span> Request Quote via WhatsApp
                </a>

                <a href="{% url 'catalog:product_list' %}"
                    style="display: inline-block; padding: 1rem 2rem; background: #666; color: white; text-decoration: none; border-radius: 4px; margin-top: 1rem;">
                    ‚Üê Back to Services
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}